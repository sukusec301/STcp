#include "CCrc32.h"
static const unsigned int crc32tab[] = {
     0X00000000L, 0X77073096L, 0XEE0E612CL, 0X990951BAL,
     0X076DC419L, 0X706AF48FL, 0XE963A535L, 0X9E6495A3L,
     0X0EDB8832L, 0X79DCB8A4L, 0XE0D5E91EL, 0X97D2D988L,
     0X09B64C2BL, 0X7EB17CBDL, 0XE7B82D07L, 0X90BF1D91L,
     0X1DB71064L, 0X6AB020F2L, 0XF3B97148L, 0X84BE41DEL,
     0X1ADAD47DL, 0X6DDDE4EBL, 0XF4D4B551L, 0X83D385C7L,
     0X136C9856L, 0X646BA8C0L, 0XFD62F97AL, 0X8A65C9ECL,
     0X14015C4FL, 0X63066CD9L, 0XFA0F3D63L, 0X8D080DF5L,
     0X3B6E20C8L, 0X4C69105EL, 0XD56041E4L, 0XA2677172L,
     0X3C03E4D1L, 0X4B04D447L, 0XD20D85FDL, 0XA50AB56BL,
     0X35B5A8FAL, 0X42B2986CL, 0XDBBBC9D6L, 0XACBCF940L,
     0X32D86CE3L, 0X45DF5C75L, 0XDCD60DCFL, 0XABD13D59L,
     0X26D930ACL, 0X51DE003AL, 0XC8D75180L, 0XBFD06116L,
     0X21B4F4B5L, 0X56B3C423L, 0XCFBA9599L, 0XB8BDA50FL,
     0X2802B89EL, 0X5F058808L, 0XC60CD9B2L, 0XB10BE924L,
     0X2F6F7C87L, 0X58684C11L, 0XC1611DABL, 0XB6662D3DL,
     0X76DC4190L, 0X01DB7106L, 0X98D220BCL, 0XEFD5102AL,
     0X71B18589L, 0X06B6B51FL, 0X9FBFE4A5L, 0XE8B8D433L,
     0X7807C9A2L, 0X0F00F934L, 0X9609A88EL, 0XE10E9818L,
     0X7F6A0DBBL, 0X086D3D2DL, 0X91646C97L, 0XE6635C01L,
     0X6B6B51F4L, 0X1C6C6162L, 0X856530D8L, 0XF262004EL,
     0X6C0695EDL, 0X1B01A57BL, 0X8208F4C1L, 0XF50FC457L,
     0X65B0D9C6L, 0X12B7E950L, 0X8BBEB8EAL, 0XFCB9887CL,
     0X62DD1DDFL, 0X15DA2D49L, 0X8CD37CF3L, 0XFBD44C65L,
     0X4DB26158L, 0X3AB551CEL, 0XA3BC0074L, 0XD4BB30E2L,
     0X4ADFA541L, 0X3DD895D7L, 0XA4D1C46DL, 0XD3D6F4FBL,
     0X4369E96AL, 0X346ED9FCL, 0XAD678846L, 0XDA60B8D0L,
     0X44042D73L, 0X33031DE5L, 0XAA0A4C5FL, 0XDD0D7CC9L,
     0X5005713CL, 0X270241AAL, 0XBE0B1010L, 0XC90C2086L,
     0X5768B525L, 0X206F85B3L, 0XB966D409L, 0XCE61E49FL,
     0X5EDEF90EL, 0X29D9C998L, 0XB0D09822L, 0XC7D7A8B4L,
     0X59B33D17L, 0X2EB40D81L, 0XB7BD5C3BL, 0XC0BA6CADL,
     0XEDB88320L, 0X9ABFB3B6L, 0X03B6E20CL, 0X74B1D29AL,
     0XEAD54739L, 0X9DD277AFL, 0X04DB2615L, 0X73DC1683L,
     0XE3630B12L, 0X94643B84L, 0X0D6D6A3EL, 0X7A6A5AA8L,
     0XE40ECF0BL, 0X9309FF9DL, 0X0A00AE27L, 0X7D079EB1L,
     0XF00F9344L, 0X8708A3D2L, 0X1E01F268L, 0X6906C2FEL,
     0XF762575DL, 0X806567CBL, 0X196C3671L, 0X6E6B06E7L,
     0XFED41B76L, 0X89D32BE0L, 0X10DA7A5AL, 0X67DD4ACCL,
     0XF9B9DF6FL, 0X8EBEEFF9L, 0X17B7BE43L, 0X60B08ED5L,
     0XD6D6A3E8L, 0XA1D1937EL, 0X38D8C2C4L, 0X4FDFF252L,
     0XD1BB67F1L, 0XA6BC5767L, 0X3FB506DDL, 0X48B2364BL,
     0XD80D2BDAL, 0XAF0A1B4CL, 0X36034AF6L, 0X41047A60L,
     0XDF60EFC3L, 0XA867DF55L, 0X316E8EEFL, 0X4669BE79L,
     0XCB61B38CL, 0XBC66831AL, 0X256FD2A0L, 0X5268E236L,
     0XCC0C7795L, 0XBB0B4703L, 0X220216B9L, 0X5505262FL,
     0XC5BA3BBEL, 0XB2BD0B28L, 0X2BB45A92L, 0X5CB36A04L,
     0XC2D7FFA7L, 0XB5D0CF31L, 0X2CD99E8BL, 0X5BDEAE1DL,
     0X9B64C2B0L, 0XEC63F226L, 0X756AA39CL, 0X026D930AL,
     0X9C0906A9L, 0XEB0E363FL, 0X72076785L, 0X05005713L,
     0X95BF4A82L, 0XE2B87A14L, 0X7BB12BAEL, 0X0CB61B38L,
     0X92D28E9BL, 0XE5D5BE0DL, 0X7CDCEFB7L, 0X0BDBDF21L,
     0X86D3D2D4L, 0XF1D4E242L, 0X68DDB3F8L, 0X1FDA836EL,
     0X81BE16CDL, 0XF6B9265BL, 0X6FB077E1L, 0X18B74777L,
     0X88085AE6L, 0XFF0F6A70L, 0X66063BCAL, 0X11010B5CL,
     0X8F659EFFL, 0XF862AE69L, 0X616BFFD3L, 0X166CCF45L,
     0XA00AE278L, 0XD70DD2EEL, 0X4E048354L, 0X3903B3C2L,
     0XA7672661L, 0XD06016F7L, 0X4969474DL, 0X3E6E77DBL,
     0XAED16A4AL, 0XD9D65ADCL, 0X40DF0B66L, 0X37D83BF0L,
     0XA9BCAE53L, 0XDEBB9EC5L, 0X47B2CF7FL, 0X30B5FFE9L,
     0XBDBDF21CL, 0XCABAC28AL, 0X53B39330L, 0X24B4A3A6L,
     0XBAD03605L, 0XCDD70693L, 0X54DE5729L, 0X23D967BFL,
     0XB3667A2EL, 0XC4614AB8L, 0X5D681B02L, 0X2A6F2B94L,
     0XB40BBE37L, 0XC30C8EA1L, 0X5A05DF1BL, 0X2D02EF8DL
};

unsigned int CCrc32::crc32(const unsigned char* buf, unsigned int size)
{
    unsigned int i, crc;
    crc = 0xFFFFFFFF;

    for (i = 0; i < size; i++)
        crc = crc32tab[(crc ^ buf[i]) & 0xff] ^ (crc >> 8);

    return crc ^ 0xFFFFFFFF;
}
